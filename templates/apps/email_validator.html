{% extends "base.html" %}

{% block title %}Email Validator - MyXAPP{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <h2 class="mb-4">üìß Email Validator</h2>
        
        <div class="card shadow">
            <div class="card-body p-4">
                <p class="lead">Valide endere√ßos de email rapidamente.</p>
                
                <div class="mb-3">
                    <label for="emailInput" class="form-label">Endere√ßo de Email</label>
                    <input type="email" 
                           class="form-control form-control-lg" 
                           id="emailInput" 
                           placeholder="exemplo@dominio.com">
                </div>
                
                <button type="button" class="btn btn-primary btn-lg w-100" onclick="validateEmail()">
                    Validar Email
                </button>
                
                <div id="result" class="mt-4" style="display: none;">
                    <div class="alert" role="alert" id="resultAlert">
                        <h5 id="resultMessage"></h5>
                        <p class="mb-0" id="resultDetail"></p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="mt-4">
            <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Voltar ao Dashboard</a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
async function validateEmail() {
    const emailInput = document.getElementById('emailInput');
    const email = emailInput.value.trim();
    
    if (!email) {
        showResult('Por favor, insira um email.', '', 'warning');
        return;
    }
    
    try {
        const response = await fetch('{{ url_for("email_validator.validate") }}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email: email })
        });
        
        const data = await response.json();
        
        if (data.valid) {
            showResult('‚úÖ Email V√°lido!', `O email "${data.email}" √© v√°lido.`, 'success');
        } else {
            showResult('‚ùå Email Inv√°lido!', `O email "${data.email}" n√£o √© v√°lido.`, 'danger');
        }
    } catch (error) {
        showResult('Erro', 'Ocorreu um erro ao validar o email.', 'danger');
    }
}

function showResult(message, detail, type) {
    const resultDiv = document.getElementById('result');
    const resultAlert = document.getElementById('resultAlert');
    const resultMessage = document.getElementById('resultMessage');
    const resultDetail = document.getElementById('resultDetail');
    
    resultAlert.className = `alert alert-${type}`;
    resultMessage.textContent = message;
    resultDetail.textContent = detail;
    resultDiv.style.display = 'block';
}

// Permitir validar com Enter
document.getElementById('emailInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        validateEmail();
    }
});
</script>
{% endblock %}